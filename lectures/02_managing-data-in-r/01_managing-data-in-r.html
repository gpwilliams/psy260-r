<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Managing Data in R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Glenn Williams" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Managing Data in R
## Importing Data into R
### Glenn Williams
### University of Sunderland
### 2021-10-26 (updated: 2021-10-27)

---






# Understanding File Systems

Before we read in any data, we need to understand file paths on your computer.

- Computers are often split up into different **drives** where you can store data: e.g. a C drive on a PC, a Macintosh HD drive on newer Macs. 

- The more drives you have, the more places data can live.

- Usually we organise files into folders on these drives.

- Any file is saved at a unique **paths** (places) on these drives.

---
# Understanding File Systems

.pull-left[

We have a file on our Desktop called "document.txt". This is a text file (.txt extension). 

How does the computer know where it is?

- On a PC, it might live at `C:\Users\glenn\Desktop\document.txt`.

- Another file, "document2.txt", could live at `C:\Users\glenn\Desktop\document2.txt`.

You need to be able to **uniquely identify** files within file paths. 

They either need unique names in a given location, or can have the same name in a different location.
]

.pull-right[

&lt;div class="figure" style="text-align: right"&gt;
&lt;img src="../../img/file_path.png" alt="A flow chart of these files on the system." width="250" /&gt;
&lt;p class="caption"&gt;A flow chart of these files on the system.&lt;/p&gt;
&lt;/div&gt;

]

---
# How R Reads Files

By default, R will either ask you to:

- Specify the **exact (absolute) file path** to access a file (e.g. `C:\Users\glenn\desktop\document.txt`), or...

- Specify a file path **relative** to the **working directory**.

Using a relative file path is best if you want your code to work on any computer besides the one you wrote your code in. That's because other computers aren't likely to have a `C:\Users\glenn\desktop` path.

Where's the **working directory** though?

---
# The Working Directory



.pull-left[

- The working directory in R by default is wherever you open up an R file, or wherever R is installed if you open RStudio without first opening a file.

- **Depending on how you start R, it could be anywhere!**

- RStudio Projects and the `here` package to the rescue!

]

.pull-right[

&lt;div class="figure" style="text-align: right"&gt;
&lt;img src="../../img/r-project.png" alt="Making an RStudio Project." width="250" /&gt;
&lt;p class="caption"&gt;Making an RStudio Project.&lt;/p&gt;
&lt;/div&gt;

]

- If you open an **RStudio Project**, your working directory is wherever the project is.

- If you read files in with `here`, no matter where your working directory is right now, it reads files **relative** to where the RStudio Project lives.

Having your work associated with an **RStudio project ensures the working directory is always the same** in any session and on any computer.

---
# Projects and Here: An Example

Read a file called **raw_data.csv** from a folder on our **desktop** called **my_data**.

.pull-left[

### Method

1. Using an **absolute file path** requires you to state exactly where the file is on your computer. This will only work on your computer.

2. Using a **relative file path** is better, but only works if the working directory is the my_data folder.

3. Using an **RStudio Project** fixes the working directory to the my_data folder. You can then read files relative to that folder using the **here function**.

]

.pull-right[

### Code


```r
# using absolute paths
read_csv(
  "C:/Users/glenn/Desktop/
  my_data/raw_data.csv"
)


# using relative paths
read_csv("my_data/raw_data.csv")



# using the here function
read_csv(here("raw_data.csv"))
```

*(3) is best for reproducibility.*

]

---
# Reading and Writing Data in R

There are a few inbuilt functions in R that allow us to read in data from a file and to write data to a file, but they sometimes take arguments in different orders and can behave unexpectedly.

- The `tidyverse` has a number of functions for both tasks that are consistent and tell you important information.

- All `tidyverse` functions that read data in from different formats start with **read_** and end in the file format after the underscore; e.g. read_csv(), read_delim(), read_tsv().

- All `tidyverse` functions that write data to file in different formats start with **write_** and end in the name of the file format; e.g. write_csv(), write_delim(), write_tsv().

---
# Reading Data into R
## An Example

- We already have some data stored in the /data/ folder. It's stored as a .csv file.

- Values in the file are separated by commas (hence, **comma-seperated values; csv**).

- It's a good idea to save data (e.g. from Excel) in this format for sharing; it's lightweight and can be read for free by most programs.

---
# Reading Data into R
## An Example

- We read the data in using `read_csv()`

- We tell R where to find the data using `here()`. 

- We then assign the data to an object called **raw_data** so we can work with it in R. 

- By default, `read_csv()` tells us how R parsed each column (i.e. what the data is stored as).


```r
raw_data &lt;- read_csv(here("data", "factorial_data.csv"))
```

```
## Parsed with column specification:
## cols(
##   subj_id = col_character(),
##   list_id = col_double(),
##   item_id = col_double(),
##   A = col_character(),
##   B = col_character(),
##   Y = col_double()
## )
```

---
# Recap

We know...

- how **file paths** work and that these paths can be very different depending upon your computer set up.

- why **relative file paths** set up in a **working directory** is often the most user-friendly method of accessing and writing files. 

- why using **RStudio Projects** and the `here` package makes working with files easier. 

- how to read different file types into R.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
