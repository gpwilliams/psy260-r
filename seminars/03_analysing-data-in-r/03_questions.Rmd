---
title: "PSY260 - Research Methods and Analysis"
subtitle: "R Workshop 3 - Analysing Data in R"
output: 
  html_document:
    css: "../../style.css"
    toc: true
    toc_float: true
    theme: united
    highlight: tango
author: "Dr Glenn Williams"
date: "2021-10-27 (Updated `r Sys.Date()`)"
---

Here, we'll get used to performing analyses and summarising data in R. This set of questions introduces some more advanced functions for analysing data. These exercises are more introductory while the questions are intended to be more difficult to help test your knowledge.

# Exercises

Please run the following code chunk before getting started. This will load the 2 crucial packages for this workshop and the raw data we will use to entrench the concepts taught in the lecture.

```{r setup, message = FALSE}
# load packages
library(tidyverse)
library(here)

# load data
raw_data <- read_csv(here("data", "seminar_three_data.csv"))
```

## Exercise 1

How many participants do we have in the experiment? How many items? Write some R code to check this.

*Hint*: `length()` and `unique()` are useful here.

```{r exercise-1-answer}

```

## Exercise 2

The labels for the conditions in column A are not very informative. Please give these suitable names in the data set.

There are (at least) two methods to achieve this. Create a column (or overwrite the existing one) using:

1. `case_when()` as in previous lectures/seminars.

2. `factor()` within `mutate()`.

*Please see the lecture on manipulating data if you get stuck.*

```{r exercise-2-answer}

```

## Exercise 3

Create a summary of the reaction times per condition for each participant grouped by the variable "A". Choose a way to summarise this based on central tendency (e.g. mean, median, mode).

Typically we use this data for inferential tests and plots.

Assign this data to the object `data_summary`.

```{r exercise-3-answer}

```

## Exercise 4

### Part A

Taking your summary data from Exercise 3, remove any participants with reaction times above 500ms. Save this to the object data_summary_filtered.

```{r exercise-4a-answer}

```

### Part B

After removing the participants in Exercise 4 part A, how many participants do you have left in your summary?

```{r exercise-4b-answer}

```

## Exercise 5

### Part A

We'd like some descriptive statistics for the central tendency and measure of dispersion across both conditions. Calculate these for the data set you created in Exercise 4 part A, data_summary_filtered. Please name the columns as simply mean and sd.

```{r exercise-5a-answer}

```

### Part B

Write a sentence to justify your choice of measure for central tendency and dispersion in your summary statistics.



## Exercise 6

In our summary we'd also like the counts for the number of participants in each condition. Please add this to your code used in Exercise 5.

```{r exercise-6-answer}

```

## Exercise 7

Taking your data from Exercise 4A, data_summary_filtered, conduct an appropriate statistical test to compare the mean scores for the congruent and incongruent conditions. Is there a significant difference between the groups?

Remember to use the formula interface `outcome ~ predictor`. This means scores to the left of the `~` are predicted by the values assigned to the right side of the `~`; i.e. your condition dictates your score.

```{r exercise-7-answer}

```



# Questions

These remaining questions are designed to push you a little further to improve your knowledge. Please complete these in your own time.

Please run the following R code chunk by pressing the green play button. This will load the data up from the "data" folder and print it out in your console.

```{r question-data, message = FALSE, warning = FALSE}
qdata <- read_csv(here("data", "cleanish_data.csv"))
qdata # inspect it
```

This data set is that from lecture 2b - Data Checking in R. The columns have the following interpretation:

- **X1** = Row number for the data.

- **subj_id** = Subject/participant ID for the person who gave the data to us.

- **list_id** = list ID for how items were randomised.

- **item_id** = Item ID.

- **variable A** = Implied sentence location (upwards or downwards); e.g. "the bird flew in the sky." a1 is up, a2 is down.

- **variable B** = Location of target (up or down on the screen). b1 is up, b2 is down.

## Question 1

Remove any unnecessary columns from this data set.

```{r question-1-answer}

```

## Question 2

Give proper levels names to the levels A1 and A2 in column A and to B1 and B2 in column B.

```{r question-2-answer}

```

## Question 3

Give proper (column) names to the variables A, B, and Y.

```{r answer-3-answer}

```

## Question 4

Make a summary of the data creating averages of the reaction times for each level of each condition for every participant. Assign this to the object `summary_data`.

```{r answer-4-answer}

```

## Question 5

Remove participants 1 through to 10 from `summary_data`.

```{r answer-5-answer}

```

## Question 6

R has a very powerful plotting pacakge called `ggplot2` which is part of the `tidyverse` family of functions. This works by building plots up layer by layer. You first define the data to plot, then how it maps onto the plot. After that, you add geometric shapes to the plot to represent the data.

To make a botplot, we might run some code as follows, with the text in caps being replaced by your variables.

```{r ggplot-example, eval = FALSE}
ggplot(data = MY_DATA, mapping = aes(x = MY_IV1, fill = MY_IV2, y = MY_DV)) +
  geom_boxplot()
```

Make a boxplot of the data. Are there any reliable differences between conditions? Explain your logic.

```{r answer-6-answer}

```


## Question 7

I have simulated some data below for a one-variable, 3-group experiment. The three groups are "control", "treatment_low", and "treatment_high" which are assigned to the column "condition" while the outcome is in the column "outcome". (It doesn't matter what this column or study represents, data only have meaning we assign to it.) This is a between-subjects design.

```{r simulate-data-question-7}
set.seed(1892)
n <- 60

simdat <- tibble(
  condition = c(
    rep("control", n), 
    rep("treatment_low", n), 
    rep("treatment_high", n)
  ),
  outcome = c(
    rnorm(n, mean = 100, sd = 15),
    rnorm(n, mean = 105, sd = 16),
    rnorm(n, mean = 124, sd = 12)
  )
)
```

Analyse this data using an appropriate ANOVA method. Report the results below.

```{r aov-question-7-answer}

```

We can follow up with our analyses to determine where the effect lies. Do this by conducting a post-hoc tests using Tukey's Honest Significant Differences method using the `TukeyHSD()` function. If you're unsure how to do this type `?TukeyHSD` in the console. This will essentially give you a series of t-tests with your *p*-values adjusted for multiplicity.

```{r tukey-hsd-question-7-answer}

```

Describe the results of this test.

*There is a significant difference between the treatment high condition and control and treatment low conditions, which don't differ.*

## Question 8

When we want to analyse two main effects from variables in an ANOVA, we can do so like this:

```{r anova-example-1, eval = FALSE}
aov(DV ~ IV1 + IV2, data = YOUR_DATA)
```

Here, any terms added to the right of the `~` are evaluated as main effects if we make their effects additive. If instead we use a multiplication symbol, we get both main effects **and interactions**.

Perform an ANOVA on the **summary_data** we created earlier. To get your typical ANOVA table output, you must use `summary(aov(...))` or assign your ANOVA model to an object and call `summary()` on that object. We would like main effects and interaction for the **sentence_location and target_location variables**. Are there any main effects or interactions here?

```{r anova-example-1-answer}

```

**There are no main effects of interactions present (all *p*s > .186).**

This answer may appear correct, but with repeated measures we need to tell R to adjust the errors (i.e. to conduct a within- rather than a between-subjects ANOVA) for any terms we want to estimate within each participant. Do this as follows:

```{r anova-example-2, eval = FALSE}
aov(
  DV ~ IV1 * IV2 + 
    Error(SUVBJECT_ID/(IV1 * IV2)), 
  data = DATA
)
```

Adjust your code to incorporate this. Do your estimates change? Can you explain why?

```{r anova-example-2-answer}

```

*The results are still non-significant. The F-values are now smaller, likely due to partialling-out any random variance that is more attributable to participant level variance rather than consistent effects.*
